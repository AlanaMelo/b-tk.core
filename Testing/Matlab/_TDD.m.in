% M-script file to launch unit tests for BTK Matlab binding
% Note: This script should be used only in the CMake build folder
function TDD
    clc
    % Path for the implemented unit tests
    addpath('@CMAKE_CURRENT_SOURCE_DIR@');
    % Path for the function TDDConfigure()
    addpath('@CMAKE_CURRENT_BINARY_DIR@');
    % Path for the functions stored in the Documentation/Wrapping/Matlab.
    addpath('@BTK_SOURCE_DIR@/Documentation/Wrapping/Matlab/btk');
    addpath('@BTK_BINARY_DIR@/Documentation/Wrapping/Matlab/btk');
    % Path for Matlab xUnit
    addpath('@BTK_SOURCE_DIR@/Utilities/matlab_xunit/xunit');
    
    % Run the unit tests
    fprintf('\n===========================================================\n');
    runtests testBTKCommon
    fprintf('\n===========================================================\n');
    runtests testBTKIO
    fprintf('\n===========================================================\n');
    runtests testBTKBasicFilters
    
    % Extra tests for the function btkC3DserverEmulation
    % if the original C3DServer is intalled
    % - Check for the OS
    if strcmp(computer, 'PCWIN')
        c3dserverDetected = true;
        % - Test if C3DServer is installed.
        try 
          actxserver('C3Dserver.C3D');
        catch
            c3dserverDetected = false;
        end
        c3dserverDetected = false;
        if (c3dserverDetected)
            % - Run the unit tests
            fprintf('\n===========================================================\n');
            runtests testC3DserverEmulation;
        end
    end